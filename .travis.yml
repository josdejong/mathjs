language: node_js
node_js:
  - 6
  - 8
  - 10

before_install:
  - npm install -g npm@6
  - npm install -g greenkeeper-lockfile@1

install: npm install

before_script: greenkeeper-lockfile-update

script: npm run test:src

after_script: greenkeeper-lockfile-upload

# NAME env var is purely cosmetic, only way to identify builds until
# https://github.com/travis-ci/travis-ci/issues/5898 is fixed.

jobs:
  include:
    - stage: other
      node_js: lts
      script: $SCRIPT
      env:
        matrix:
          - SCRIPT='npm run lint'
          - SCRIPT='npm run test:browser'
          - SCRIPT='if [ "$TRAVIS_PULL_REQUEST" = "false" ]; then npm run test:browserstack; else true; fi'
          - SCRIPT='npm run build && npm run test:dist'

git:
  depth: 5

cache:
  directories:
    - node_modules
